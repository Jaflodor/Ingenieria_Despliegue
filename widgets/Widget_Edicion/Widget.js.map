{"version":3,"sources":["../../../widgets/Widget_Edicion/Widget.js"],"names":["define","lang","ready","parser","array","declare","BaseWidget","dom","on","FeatureLayer","GeometryService","Editor","TemplatePicker","BorderContainer","ContentPane","baseClass","postCreate","inherited","arguments","mapa","map","console","log","startup","capaCentrales","capaCableado","capaEmpalmes","capaConductos","capaDepositos","outFields","addLayers","onOpen","initEditor","results","layerInfosWildfire","layers","result","featureLayer","layer","layerObjects","tpPicker","featureLayers","columns","rows","editorSettings","geometryService","layerInfos","toolbarVisible","templatePicker","createOptions","polygonDrawTools","CREATE_TOOL_FREEHAND_POLYGON","CREATE_TOOL_RECTANGLE","CREATE_TOOL_TRIANGLE","CREATE_TOOL_CIRCLE","toolbarOptions","reshapeVisible","enableUndoRedo","maxUndoRedoOperations","editorParams","settings","widgetEditor","onClose"],"mappings":"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","file":"Widget.js","sourcesContent":["define([\"dojo/_base/lang\",\"dojo/ready\",\"dojo/parser\", \"dojo/_base/array\", 'dojo/_base/declare', 'jimu/BaseWidget',\"dojo/dom\",\"dojo/on\",\"esri/layers/FeatureLayer\",\"esri/tasks/GeometryService\",\"esri/dijit/editing/Editor\",\r\n\"esri/dijit/editing/TemplatePicker\",\"dijit/layout/BorderContainer\",\r\n\"dijit/layout/ContentPane\"],\r\nfunction(lang, ready,parser, array, declare, BaseWidget, dom, on, FeatureLayer, GeometryService, Editor,  TemplatePicker,BorderContainer, ContentPane) {\r\n  //To create a widget, you need to derive from BaseWidget.\r\n  return declare([BaseWidget], {\r\n\r\n     \r\n\r\n    // Custom widget code goes here\r\n\r\n    baseClass: 'widget-edicion',\r\n    // this property is set by the framework when widget is loaded.\r\n    // name: 'Widget_Edicion',\r\n    // add additional properties here\r\n\r\n    //methods to communication with app container:\r\n    postCreate: function() {\r\n      this.inherited(arguments);\r\n      mapa = this.map\r\n      console.log(mapa)\r\n    },\r\n    \r\n    startup: function() {\r\n     this.inherited(arguments);\r\n\r\n     // Declaramos las variables que contienen las capas a cargar en el mapa:\r\n        \r\n     var capaCentrales, capaCableado, capaEmpalmes, capaConductos, capaDepositos,\r\n        \r\n     capaCentrales = new FeatureLayer(\"https://localhost:6443/arcgis/rest/services/Proyecto/ServicioCableado/FeatureServer/3\",{\r\n         outFields: ['*']\r\n     });\r\n     capaCableado = new FeatureLayer (\"https://localhost:6443/arcgis/rest/services/Proyecto/ServicioCableado/FeatureServer/4\",{\r\n         outFields: ['*']\r\n     });\r\n     capaEmpalmes = new FeatureLayer (\"https://localhost:6443/arcgis/rest/services/Proyecto/ServicioCableado/FeatureServer/0\",{\r\n         outFields: ['*']\r\n     });\r\n\r\n     capaConductos = new FeatureLayer(\"https://localhost:6443/arcgis/rest/services/Proyecto/ServicioCableado/FeatureServer/5\", {\r\n       outFields: ['*']\r\n     })\r\n\r\n     capaDepositos = new FeatureLayer (\"https://localhost:6443/arcgis/rest/services/Proyecto/ServicioCableado/FeatureServer/1\", {\r\n       outFields: ['*']\r\n     })\r\n\r\n     // A침adimos las capas al mapa:\r\n     mapa.addLayers([capaConductos,capaCableado, capaDepositos, capaEmpalmes, capaCentrales])\r\n     \r\n    },\r\n\r\n    onOpen: function(){\r\n      ready(function () {\r\n\r\n        \r\n\r\n        // Lanzamos el evento que lanza la funci칩n cuando las capas se a침adan al mapa permita editas dichas Feature Layer:\r\n        mapa.on(\"layers-add-result\", initEditor);\r\n\r\n        ;\r\n\r\n        function initEditor(results) {\r\n\r\n            var layerInfosWildfire = array.map(results.layers, function (result) {\r\n                return {\r\n                    featureLayer: result.layer\r\n                };\r\n            });\r\n\r\n\r\n            var layerObjects = array.map(results.layers, function (result){\r\n                return result.layer\r\n            })\r\n\r\n            // A침adimos el TemplatePicker al widget\r\n            var tpPicker = new TemplatePicker({\r\n                featureLayers: layerObjects,\r\n                columns:6,\r\n                rows: \"auto\",\r\n            },\"divLeft\")\r\n            tpPicker.startup();\r\n\r\n            // Configuramos las configuraciones del editor:\r\n            var editorSettings = {\r\n                map: mapa,\r\n                geometryService: new GeometryService('http://sampleserver6.arcgisonline.com/arcgis/rest/services/Utilities/Geometry/GeometryServer'),\r\n                layerInfos: layerInfosWildfire,\r\n                toolbarVisible:true,\r\n                templatePicker: tpPicker,\r\n                createOptions: {\r\n                    polygonDrawTools: [\r\n                        Editor.CREATE_TOOL_FREEHAND_POLYGON,\r\n                        Editor.CREATE_TOOL_RECTANGLE,\r\n                        Editor.CREATE_TOOL_TRIANGLE,\r\n                        Editor.CREATE_TOOL_CIRCLE\r\n                    ]\r\n                },\r\n                toolbarOptions: {\r\n                    reshapeVisible:true\r\n                },\r\n                enableUndoRedo:true,\r\n                maxUndoRedoOperations:200\r\n            }\r\n\r\n            /*\r\n             * Step: Build the Editor constructor's first parameter\r\n             */\r\n            var editorParams = {\r\n                settings: editorSettings\r\n            }\r\n\r\n\r\n            /*\r\n             * Step: Construct the Editor widget\r\n             */\r\n            var widgetEditor = new Editor(editorParams,\"divTop\")\r\n            widgetEditor.startup();\r\n        };\r\n    });\r\n    },\r\n\r\n    onClose: function(){\r\n\r\n      // mapa.removeLayer(capaCableado)\r\n      // mapa.removeLayer(\"https://localhost:6443/arcgis/rest/services/Proyecto/ServicioCableado/FeatureServer/3\")\r\n      // mapa.removeLayer(capaConductos)\r\n      // mapa.removeLayer(capaDepositos)\r\n      // mapa.removeLayer(capaEmpalmes)\r\n\r\n\r\n    },\r\n\r\n    // onMinimize: function(){\r\n    //   console.log('Widget_Edicion::onMinimize');\r\n    // },\r\n\r\n    // onMaximize: function(){\r\n    //   console.log('Widget_Edicion::onMaximize');\r\n    // },\r\n\r\n    // onSignIn: function(credential){\r\n    //   console.log('Widget_Edicion::onSignIn', credential);\r\n    // },\r\n\r\n    // onSignOut: function(){\r\n    //   console.log('Widget_Edicion::onSignOut');\r\n    // }\r\n\r\n    // onPositionChange: function(){\r\n    //   console.log('Widget_Edicion::onPositionChange');\r\n    // },\r\n\r\n    // resize: function(){\r\n    //   console.log('Widget_Edicion::resize');\r\n    // }\r\n\r\n    //methods to communication between widgets:\r\n\r\n  });\r\n\r\n});\r\n"]}